<!DOCTYPE html>
<html lang="en">
<head>
    <script src="webglhelper.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>
	<script src="http://x3dom.org/download/current/x3dom.js"></script>
    <meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge">
    <title>Does My Browser Support X3DOM?</title>
    <style>
    .details {
      width: 60%;
      font: 10pt verdana;
      margin: 1.5em auto 0 auto;
      text-align: left;
      padding: 2px;
      border: 1px solid black;
	  border-collapse:collapse;
    }
    
	.details caption {
		padding:0 0 1em 2px;
		text-align:left;
		font-weight:bold;
	}
	.details td {padding:4px}
	
    h1 {
      margin: 0;
      font: bold 200px verdana;
      color: #000;
      text-align: center;
    }
    
    .centered {
        text-align: center;
    }

	x3d {display:none;}
    </style>
</head>
  
<body onload="init()">
  <x3d id="x3de" showStat="false" showLog="false" width="0px" height="0px">
      <scene></scene>
  </x3d>

  <table class="details" id="browser">
    <caption>Browser information</caption>
  </table>

  <table class="details" id="x3dom">
    <caption>X3DOM JS frontend</caption>
  </table>

  <table class="details" id="native">
    <caption>Native backend</caption>
  </table>

  <table class="details" id="plugin">
    <caption>X3D plugin backend <small>(<a href='http://www.instantreality.org/story/modules/' target="_blank">instantPlugin</a>)</small></caption>
  </table>

  <table class="details" id="webgl">
    <caption>WebGL backend</caption>
  </table>

  <table class="details" id="flash">
    <caption>Flash backend</caption>
  </table>

    
    <p class="centered">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">
      <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc/3.0/88x31.png" /></a>
    </p>


    <script type="text/javascript">
        var runtimeReady = false;
        x3dom.runtime.ready = function() {
            runtimeReady = true;
        }

        function init() {
          var detailCounter = 0;

	  function list(arguments) {
		var o = {};
		for(var i=0;i<arguments.length;i++) {
			o[arguments[i]]=null;
		}
		return o;
	  }

      function getParam(str){
        return ctx.getParameter(str);
      }
      
      function addLine(tableID, name, value){
        if(typeof(value) === "object"){
          var temp = "";
          for(var i = 0; i < value.length; i++){
            temp += value[i];
            if(i < value.length-1){
              temp += ", ";
            }
          }
          value = temp;
        }

        var table = getTag(tableID);
        
        var tr = document.createElement("tr");
        var tdName = document.createElement("td");
        tdName.setAttribute('class', 'left');
        tdName.style.whiteSpace = 'nowrap';
        var tdValue = document.createElement("td");
        
        // Highlight every other line to make reading a bit easier
        if(detailCounter%2 === 0){
          tr.style.background = "#CCC";
        }
        detailCounter++;
          
        tdName.innerHTML += name;
        tdValue.innerHTML += value;
        
        tr.appendChild(tdName);
        tr.appendChild(tdName);
        tr.appendChild(tdValue);        
        table.appendChild(tr);
      }
      
      function getTag(str){
        return document.getElementById(str);
      }
      
      var cvs = document.createElement('canvas');
      var contextNames = ["webgl","experimental-webgl","moz-webgl","webkit-3d"];
      var ctx;

      if(navigator.userAgent.indexOf("MSIE") >= 0) {
        try{
          ctx = WebGLHelper.CreateGLContext(cvs, 'canvas');
         }catch(e){}
      }
      else{
        for(var i = 0; i < contextNames.length; i++){
          try{
            ctx = cvs.getContext(contextNames[i]);
            if(ctx){
              addLine('webgl','Context Name', contextNames[i]);
              break;
            }
          }catch(e){}
        }
	  }
	  
	
    addLine('browser','Platform', navigator.platform);
    addLine('browser','Agent', navigator.userAgent);
		
	addLine('native','n/a', "");

     var element = document.getElementById('x3de');

     if (runtimeReady) {

        addLine('x3dom','X3DOM loaded', "Yes");


    	addLine('x3dom','X3DOM version', x3dom.versionInfo.version);
	    if (x3dom.versionInfo.revision) {
		    addLine('x3dom','X3DOM revision',   x3dom.versionInfo.revision);
	    }
	    if (x3dom.versionInfo.date) {
		    addLine('x3dom','X3DOM date',   x3dom.versionInfo.date);
	    }
	    addLine('x3dom','X3DOM backend', element.runtime.backendName());

    }

	var plugin_available = false;
	var filenames = ['npirplay.dll', 'InstantPluginATX.ocx', 'AVALONATX.InstantPluginATXCtrl.1'];
	for (i = 0; i < navigator.plugins.length; ++i) {
		if (navigator.plugins[i].filename in list(filenames)) {
			addLine('plugin','Plugin', "Yes (" +navigator.plugins[i].filename + ")");
			plugin_available = true;
		}
	}
	
	if (!plugin_available) {
		addLine('plugin','n/a', "");
	}

    if(ctx){
        addLine('webgl','Vendor', getParam(ctx.VENDOR));
        addLine('webgl','Version', getParam(ctx.VERSION));
        addLine('webgl','Renderer', getParam(ctx.RENDERER));
        addLine('webgl','Shading Language Version', getParam(ctx.SHADING_LANGUAGE_VERSION));
        
        addLine('webgl', 'RGBA Bits', getParam(ctx.RED_BITS) + ", "+ getParam(ctx.GREEN_BITS) + ", " + getParam(ctx.BLUE_BITS) + ", " + getParam(ctx.ALPHA_BITS));
        addLine('webgl', 'Depth Bits', getParam(ctx.DEPTH_BITS));
        
        addLine('webgl','Max Vertex Attribs', getParam(ctx.MAX_VERTEX_ATTRIBS));
        addLine('webgl','Max Vertex Texture Image Units', getParam(ctx.MAX_VERTEX_TEXTURE_IMAGE_UNITS));
        addLine('webgl','Max Varying Vectors', getParam(ctx.MAX_VARYING_VECTORS));        
        addLine('webgl','Max Uniform Vectors', getParam(ctx.MAX_VERTEX_UNIFORM_VECTORS));
        
        addLine('webgl', 'Max Combined Texture Image Units', getParam(ctx.MAX_COMBINED_TEXTURE_IMAGE_UNITS));
        addLine('webgl', 'Max Texture Size', getParam(ctx.MAX_TEXTURE_SIZE));
        addLine('webgl', 'Max Cube Map Texture Size', getParam(ctx.MAX_CUBE_MAP_TEXTURE_SIZE));
        addLine('webgl', 'Num. Compressed Texture Formats', getParam(ctx.NUM_COMPRESSED_TEXTURE_FORMATS));

        addLine('webgl', 'Max Render Buffer Size', getParam(ctx.MAX_RENDERBUFFER_SIZE));
        addLine('webgl', 'Max Viewport Dimensions', getParam(ctx.MAX_VIEWPORT_DIMS));
        addLine('webgl', 'Aliased Line Width Range', getParam(ctx.ALIASED_LINE_WIDTH_RANGE));
        addLine('webgl', 'Aliased Point Size Range', getParam(ctx.ALIASED_POINT_SIZE_RANGE));
        addLine('webgl', 'Supported Extensions', ctx.getSupportedExtensions().length === 0 ? "none" :ctx.getSupportedExtensions());
      } else {
        document.body.removeChild(document.getElementById('webgl'));
      }
	  
	var isFlashAvailable = swfobject.hasFlashPlayerVersion("11.0.0");
	if (!isFlashAvailable) {
		addLine('flash','Flash 11+ is not installed',"");
	} else {
		flashVersion = swfobject.getFlashPlayerVersion();
		addLine('flash','Flash version', flashVersion.major + "." + flashVersion.minor + "." + flashVersion.release);
	}
    };
    </script>

</body>
</html>
