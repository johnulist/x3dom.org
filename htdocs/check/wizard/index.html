<!DOCTYPE html>
<!--
This file should detect which OS/Browser and plugin support is available.
And then display a suggestion what to download or update. It should
be as self-contained as possible avoiding too many requests.

Portions of code from:
http://www.quirksmode.org/js/detect.html
http://get.webgl.org/

X3DOM application requires a WebGL renderer
Pass in information what the application requires index.html#0100 <- feature matrix bitmask
Send feedback mail with browser data, etc.
-->
<html>
<head>
    <!--<meta http-equiv="X-UA-Compatible" content="chrome=1">-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>X3DOM Help Wizard</title>
    <link rel="stylesheet" href="normalize.css">
    <script src="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="http://x3dom.org/download/1.3/x3dom.js"></script>
    <script>window.jQuery || document.write('<script src="jquery-1.7.1.min.js"><\/script>')</script>
    <script src="detect.js"></script>
    <style>
        /* Style goes here */
        body, html  { height: 100%; }
        h1,h2,h3,h4 { text-rendering: optimizeLegibility; line-height:1.6em; }

        body {
            font-family: "Helvetica Neue", "Helvetica", Arial, sans-serif;
            font-size: 1em;
            line-height: 1.6em;
            margin: 0;
            padding: 0;
            background: white;
            color: #333;
            text-align: center;
        }

        a,
        a:visited,
        a:active,
        a:focus,
        a:hover { text-decoration: none; }

        a:hover  { color: white; background-color: #333; border-radius: 2px; padding: 2px; margin: -2px; }
        
        ol li {
            list-style:none;
        }
        
        #page    { height: 100%; overflow: visible; position: relative; }

        #inner   {
            position: relative;
            top: 5%;
            width: 80%;
            margin: 0 auto;
            /*box-shadow:0px 0px 40px rgba(0,0,0,0.2) ;*/
            /*border-radius: 5px;*/
            max-width:52em;
        }

        #footer { padding: 10px 20px 10px 20px; color:#999; font-size:0.6em; }

        #footer a,
        #footer a:hover,
        #footer a:visited,
        #footer a:active { font-weight: bold;  color: #777; }


        .head   { padding: 1em; color:white; }
        .head p { color: #333;}

        .ok     { color: green; }

        .critical,
        .fatal { color: red; }

        .warn {color:#556b2f;}
        .head h1 {
            font-weight: normal;
            letter-spacing: -1px;
            /*margin:0 0 10px 0;*/
            /*padding: 0;*/
            /*line-height:1em;*/
         }

        /*.head .info { font-size: 19px }*/


        .solution { padding: 10px 20px 20px 20px; margin: 0 auto; }
        .solution h2 { margin: 1em 0 .5em 0; }
        .solution h3 { margin: 1.6em 0 .8em 0; }
        .solution a:hover { border-bottom:  1px solid  #21558c; }
        .solution p { margin-bottom:1em; }
        .solution p:last-child { margin-bottom:0; }

        .hidden { display:none; }
    </style>


    <script>
        $j = jQuery.noConflict();
        $j(document).ready(function() {
            var canvas;
            var gl, experiental;

            var has_web_gl = false;
            var has_flash  = false;
            var x3d_element = null;
            
            b = BrowserDetect;
            b.init();

            $j('#no-javascript').hide();
            $j("#support-link").attr('href', b.urls.troubleshootingUrl);

            // info
            $j('#info-browser-name').text(b.browser);
            $j('#info-browser-version').text(b.version);

            $j('#more-link').click(function() {
                $j('#more-content').toggle();
            });


            if (b.browser == "Explorer") {
                $j('#upgrade-browser').hide();
                $j('#upgrade-chromeframe').show();
            }

            canvas = document.getElementById("x3dom-logo");

            try {
                gl = canvas.getContext("webgl");
            } catch (x) {
                gl = null;
            }

            if (gl == null) {
                try {
                    gl = canvas.getContext("experimental-webgl");
                    experimental = true;
                } catch (x) {
                    gl = null;
                }
            }

            if (gl) {
                // webgl works
                has_web_gl = true;
            } else if ("WebGLRenderingContext" in window) {

            } else {
                // no webgl
                has_web_gl = false;
            }

            // detect flash
            if (swfobject.hasFlashPlayerVersion('11.0.0')) {
                has_flash = true;
            }

            var flash_version = $j("#flash-version");

            if (has_flash) {
                flash_version.text(swfobject.getFlashPlayerVersion().major);
            } else {
                flash_version.text("You need at least flash 11.");
            }


            if (!has_web_gl && !has_flash) {
                $j("#no-webgl-no-flash").show();
                // Do we know the browser and can it be upgraded?
                if (b.browser != "unknown" && b.urls.upgradeUrl) {
                    // Yes, show the browser and the upgrade link.
                    $j("#name").html(b.browser);
                    $j("#upgrade-link").attr('href', b.urls.upgradeUrl);
                } else {
                    // No, so only the link for browser for this platform.
                    randomizeBrowserList();
                    $j("#upgrade-browser").hide();
                    $j("#get-browser").show();
                    $j("#platform").html(b.platform);
                }
            } else {
                $j("#all-go").show();

                x3d_element = document.getElementById('logo');
                x3dom.runtime.ready = function() {
                    if (x3d_element.runtime.backendName() == 'flash') {
                        $j('#using-flash').show();
                    }
                };



            }


            function randomizeBrowserList() {
                var bl = $j("#browser-list");
                var browsers = [];
                var infos = b.platformInfo.browsers;
                for (var ii = 0; ii < infos.length; ++ii) {
                    browsers.push({
                        info: infos[ii],
                        weight: Math.random()
                    });
                }

                browsers = browsers.sort(function(a, b) {
                    if (a.weight < b.weight) return -1;
                    if (a.weight > b.weight) return 1;
                        return 0;
                    });

                    for (var ii = 0; ii < browsers.length; ++ii) {
                        var info = browsers[ii].info;
                        var div = document.createElement("p");
                        var a = document.createElement("a");
                        a.href = info.url;
                        a.innerHTML = info.name;
                        div.appendChild(a);
                        bl.append(div);
                    }
                }

        });
    </script>

</head>
<body>
<canvas id="x3dom-logo" style="display:none"></canvas>

<div id="page"><div id="inner">

    <!--
    This section helps if javascript is off
    TODO: fix copy, maybe screenshots
    -->
    <div id="no-javascript">

        <div class="head fatal">
            <h1>You must enable JavaScript in order to use&nbsp;X3DOM</h1>
        </div>

        <div class="solution">
            <h2>Here is what you can do</h2>
            <p>First, identify your browser make. Then use the guidelines below to enable JavaScript for your&nbsp;browser.
            If you are using an old borwser the settings might slightly differ. If you can not find the appropriate option
            with the guidelines below, please consult the help system of your browser.</p>


            <!--[if IE]>
                <h3>Internet Explorer</h3>
                <p>
                    Go to the Settings menu and select "Internet Options".
                    In the dialog box go to the "Security" tab.
                    Click the button "Cusomtize Level...".
                    In the "Scripting" section set the "Active Scripting" option to "Active".
                </p>
            <![endif]-->

            <h3>Firefox</h3>
            <p>
                In the Firefox menu select "Options".
                In the dialog that appears select the "Content" section.
                Check the "Enable JavaScript" option.
           </p>

            <h3>Chrome</h3>
            <ol>
                <li>Go to the Chrome settings menu (dark wrench next to the URL bar).</li>
                <li>Select "Preferences".</li>
                <li>On the right, select the "Unter the hood" tab.</li>
                <li>In the Privacy area click on "Content Settings".</li>
                <li>In the JavaScript section activate "Allow all sites to run JavaScript (recommended)".</li>

            </ol>

            <h3>Browser not listed here?</h3>
            <p>Please see the reference manual of your browser in oder to enable Javascript.</p>
        </div>
    </div>

      <div id="no-webgl-no-flash" class="hidden">
          <div class="head critical">
              <h1>Your browser does not know WebGL and has no compatible Flash</h1>
          </div>

          <div class="solution">
              <!-- solution steps -->
              <h2>Here is what you can do</h2>
                <div id="upgrade-browser">
                    <p><a id="upgrade-link" href="">You can upgrade <span id="name"></span> by clicking this&nbsp;link.</a></p>
                </div>

               <!--[if IE]>
              <div id="upgrade-chromeframe">
                  <p><a href="http://www.google.com/chromeframe/eula.html"><strong>Install chrome frame</strong></a> for best experience or <a href="http://get.adobe.com/flashplayer/">install the latest flash player</a> if chome frame is
                  not an&nbsp;option.</p>
              </div>
              <![endif]-->

              <div id="get-browser">
                <p>You may want to get another browser that supports WebGL. The following browsers support WebGL on <span id="platform"></span>
                    and allow to render X3DOM&nbsp;content:</p>

                 <div id="browser-list"></div>
              </div>

              <div class="more">
                  <h4><a href="#" id="more-link">Can't install software on your computer?</a></h4>
                  <div id="more-content" class="hidden">
                    <p>If you are in a corporate environment or governmental organization, it is quite possible the IT department
                    prevents you from installing software on your computer. If you know this is the case, please contact your
                    IT department and show them this&nbsp;message.</p>

                    <p>In case you don't know if you can or can not install software on your computer, just give it a try.
                    If you find out it's not possible, please contact your system administrator, IT guy, or ask your
                    boss or a collegue how to&nbsp;proceed.</p>
                  </div>
              </div>
          </div>
      </div>


    <!--
    Everything works fine.
    -->
    <div id="all-go" class="hidden">
        <div class="head ok">
            <h1>Your browser supports X3DOM</h1>
            <p class="info">
                You are surfing with <strong id="info-browser-name"></strong>&nbsp;version
                <strong id="info-browser-version"></strong>&nbsp;with Flash <strong id="flash-version"></strong>&nbsp;installed. Perfect.
            </p>
        </div>

        <x3d id="logo" showLog="false"  width="300px" height="300px">
            <scene>
                <viewpoint position='0 0 10' ></viewpoint>
            <shape>
                <appearance>
                    <material diffuseColor='0.603 0.894 0.909' ></material>
                </appearance>
                <box DEF='box' ></box>
            </shape>
            </scene>
        </x3d>

        <p>You should see a cyan box above and be able to move it around by dragging it with your&nbsp;mouse.</p>

        <div class="solution">
            
            <div id="using-flash" class="warn hidden">
                <p>
                    3D content works best with WebGL. X3DOM currently uses flash to render scenes.
                    For best performance, consider enabling WebGL in your browser or updating to a
                    recent browser version which supports WebGL&nbsp;natively.
                </p>

            </div>

            <!--[if IE]>
            <div id="upgrade-chromeframe">
                <p>You may want to try <a href="http://www.google.com/chromeframe/eula.html"><strong>chrome frame</strong></a> for best X3DOM
                experience in IE.</p>
            </div>
            <![endif]-->

            <p>Still too slow? Upgrade to a faster graphics card with more memory to speed up your X3DOM&nbsp;experience.
            </p>
            
        </div>
    </div>

    <div id="footer">
        <p>Brought to you by the <a href="http://x3dom.org">X3DOM</a> project</p>
    </div>
  </div> <!-- /inner -->


</div></body>
</html>

