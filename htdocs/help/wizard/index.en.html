<!DOCTYPE html>
<!--
This file should detect which OS/Browser and plugin support is available.
And then display a suggestion what to download or update. It should
be self-contained. No external resources needed, images, if required,
should be encoded as b64 in CSS or img tag.</p>

Portions of code from:
http://www.quirksmode.org/js/detect.html
http://get.webgl.org/

X3DOM application requires a WebGL renderer
Pass in information what the application requires index.html#0100 <- feature matrix bitmask
Send feedback mail with browser data, etc.
-->
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>X3DOM Help Wizard</title>
    <link rel="stylesheet" href="normalize.css" />
    <link rel="stylesheet" href="wizard.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="jquery-1.7.1.min.js"><\/script>')</script>
    <script src="detect.js"></script>
    <style>
                /* Style goes here */
        body, html { height: 100%; }
        h1,h2,h3,h4 { text-rendering: optimizeLegibility; }

        body {
            font-family:  "Helvetica Neue", "Helvetica", Arial, sans-serif;
            font-size: 13px;
            margin: 0;
            padding: 0;
            background: #999;
            color: #333;
        }

        a,
        a:visited,
        a:active,
        a:focus,
        a:hover { text-decoration: none; }

        a:hover { color: white; background-color: #333; border-radius: 2px; padding: 2px; margin: -2px; }

        #page { height: 100%; overflow: visible; position: relative; }

        #inner {
            position: relative;
            top: 5%;
            width: 80%;
            margin: 0 auto;
            background: white;
            box-shadow:0px 0px 40px rgba(0,0,0,0.2) ;
            border-radius: 5px;
            max-width:52em;
        }

        #footer {
            padding: 10px 20px 10px 20px;
            color:#999;
            font-size:11px;
            background-color: #eee;
            border-radius: 0 0 5px 5px;
        }

        #footer a,
        #footer a:hover,
        #footer a:visited,
        #footer a:active { font-weight: bold;  color: #777; }


        .head {
            padding: 20px;
            background: #556b2f;
            border-radius: 5px 5px 0 0;
            color:white;

        }

        .ok { background-color: #556b2f; }

        .warning { background-color: #556b2f; }
        .warning p strong { color: yellow; }
        .critical { background-color: #8b0000; }
        .fatal { background-color: red; }


        .head h1 {
            font-size: 24px;
            margin:0 0 10px 0;
            padding: 0;
         }

        .head .info { font-size: 19px }


        .solution { padding: 10px 20px 20px 20px; line-height: 1.6em;  margin: 0 auto; }
        .solution h2 { font-size: 16px; margin: 1em 0 .5em 0; }
        .solution h3 { margin: 1.6em 0 .8em 0; }
        .solution a:hover { border-bottom:  1px solid  #21558c; }
        .solution p { margin-bottom:1em; }
        .solution p:last-child { margin-bottom:0; }

    </style>


    <script>
        $j = jQuery.noConflict();
        $j(document).ready(function() {
            var canvas;
            var gl, experiental;

            var has_web_gl = false;
            var has_flash  = false;

            b = BrowserDetect;
            b.init();

            $j('#no-javascript').hide();

            // set  support link to the correct URL for the browser.
            $j("#support-link").attr('href', b.urls.troubleshootingUrl);

            // info
            $j('#info-browser-name').text(b.browser);
            $j('#info-browser-version').text(b.version);

            canvas = document.getElementById("x3dom-logo");

            try {
                gl = canvas.getContext("webgl");
            } catch (x) {
                gl = null;
            }

            if (gl == null) {
                try {
                    gl = canvas.getContext("experimental-webgl");
                    experimental = true;
                } catch (x) {
                    gl = null;
                }
            }

            if (gl) {
                // webgl works
                has_web_gl = true;
            } else if ("WebGLRenderingContext" in window) {

            } else {
                // no webgl
                has_web_gl = false;
            }

            // detect flash
            if (swfobject.hasFlashPlayerVersion('11.0.0')) {
                has_flash = true;
            }

            var flash_version = $j("#flash-version");
            if (has_flash) {
                flash_version.text(swfobject.getFlashPlayerVersion().major);
            } else {
                flash_version.text("You need at least flash 11.");
            }

            if (!has_web_gl || !has_flash) {
                $j("#no-webgl-no-flash").show();
                // Do we know the browser and can it be upgraded?
                if (b.browser != "unknown" && b.urls.upgradeUrl) {
                    // Yes, show the browser and the upgrade link.
                    $j("#name").html(b.browser);
                    $j("#upgrade-link").attr('href', b.urls.upgradeUrl);
                } else {
                    // No, so only the link for browser for this platform.
                    randomizeBrowserList();
                    $j("#upgrade-browser").hide();
                    $j("#get-browser").show();
                    $j("#platform").html(b.platform);
                }
            } else {
                $j("#all-go").show();
            }


            function randomizeBrowserList() {
                var bl = $j("#browser-list");
                var browsers = [];
                var infos = b.platformInfo.browsers;
                for (var ii = 0; ii < infos.length; ++ii) {
                    browsers.push({
                        info: infos[ii],
                        weight: Math.random()
                    });
                }

                browsers = browsers.sort(function(a, b) {
                    if (a.weight < b.weight) return -1;
                    if (a.weight > b.weight) return 1;
                        return 0;
                    });

                    for (var ii = 0; ii < browsers.length; ++ii) {
                        var info = browsers[ii].info;
                        var div = document.createElement("p");
                        var a = document.createElement("a");
                        a.href = info.url;
                        a.innerHTML = info.name;
                        div.appendChild(a);
                        bl.append(div);
                    }
                }

        });
    </script>

</head>
<body>
<canvas id="x3dom-logo" style="display:none"></canvas>

<div id="page"><div id="inner">

    <!--
    This section helps if javascript is off
    TODO: fix copy, maybe screenshots
    -->
    <div id="no-javascript">

        <div class="head fatal">
            <h1>You must enable JavaScript in order to use X3DOM.</h1>
        </div>

        <div class="solution">
            <h2>Here is what you can do</h2>
            <p>Identify your browser first, then use the guidelines below to enable JavaScript for your browser.</p>

            <h3>Internet Explorer</h3>
            <p>Go to menue, do blah.</p>

            <h3>Firefox</h3>
            <p>Go to menue, do blah.</p>

            <h3>Chrome</h3>
            <p>Go to menue, do blah.</p>

            <h3>Browser not listed here?</h3>
            <p>Please see the reference manual of your browser in oder to enabel Javascript.</p>
        </div>
    </div>



      <div id="no-webgl-no-flash" style="display:none">
          <div class="head critical">
              <h1>Your browser does not know WebGL and has no compatible Flash.</h1>
          </div>

          <div class="solution">
              <!-- solution steps -->
              <h2>Here is what you can do</h2>
                <div id="upgrade-browser">
                    <p><a id="upgrade-link" href="">You can upgrade <span id="name"></span> by clicking this link.</a></p>
                </div>
              <!-- IE -->
              <div id="solution-ie">
                  <p><a href="http://www.google.com/chromeframe/eula.html"><strong>Install chrome frame</strong></a> for best experience or <a href="http://get.adobe.com/flashplayer/">install the latest flash player</a> if chome frame is
                  not an option.</p>
              </div>


              <div id="get-browser">
                <p>You may want to download one of the following browsers to view X3DOM content.</p>
                <p>The following browsers support WebGL on <span id="platform"></span>:</p>

                 <div id="browser-list">
                 </div>
              </div>

              <div class="more">
                  <h3>Can't install software on your computer?</h3>
                  <p>If you are in a corporate environment or governmental organization, it is quite possible the IT department
                  prevents you from installing software on your computer. If you know this is the case, please contact your
                  IT department and show them this message.</p>

                  <p>In case you don't know if you can or can not install software on your computer, just give it a try.
                  If you find out it's not possible, please contact your system administrator, IT guy, or ask your
                  boss or a collegue how to proceed.</p>
              </div>
          </div>
      </div>


    <!--
    Everything works fine.
    -->
    <div id="all-go" style="display:none">
        <div class="head warning">
            <h1>All systems go.</h1>
            <p class="info">
                You are surfing on <strong id="info-browser-name"></strong> version
                <strong id="info-browser-version"></strong> with Flash <strong id="flash-version"></strong> installed. Perfect.
            </p>
        </div>

        <div class="solution">
            <p>You are using a browser that supports X3DOM. To further speed things up,
                you can upgrade to a faster graphics card with more RAM, or try different browsers to speed up your
                X3DOM experience.
            </p>
            
        </div>
    </div>


    <div id="footer">
        <p>Brought to you by the <a href="http://x3dom.org">X3DOM</a> project</p>
    </div>
  </div> <!-- /inner -->



</div></body>
</html>

